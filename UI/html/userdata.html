<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="viewport" content="initial-scale=1, maximum-scale=1">
      <title>Payment</title>
      <meta name="keywords" content="">
      <meta name="description" content="">
      <meta name="Yves Byiringiro" content="">
      <link rel="icon" href="/assets/images/tablogo.png" type="image/png"/>
      <link rel="stylesheet" href="/css/bootstrap.min.css">
      <link rel="stylesheet" href="/css/style.css">
      <link rel="stylesheet" href="/css/responsive.css">
      <link rel="icon" href="/assets/images/fevicon.png" type="image/gif" />
      <link rel="stylesheet" href="/css/jquery.mCustomScrollbar.min.css">
      <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css" media="screen">
      <style>
        /* Basic body styling (optional) */
        body {
            font-family: Arial, sans-serif;
        }
        body.custom-modal-open {
            overflow: hidden;
        }

        /* The Modal (background overlay) */
        .custom-modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1000; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0,0,0,0.5); /* Black w/ opacity - this is the backdrop */
        }

        /* Modal Content Box */
        .custom-modal-content {
            background-color: #fefefe;
            margin: 5% auto; /* Adjusted margin to give more vertical space */
            padding: 0;
            border: 1px solid #888;
            width: 90%; /* Increased width for policy content */
            max-width: 800px; /* Max width for responsiveness */
            box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);
            animation-name: animatetopRealistic; /* Using the more realistic animation */
            animation-duration: 0.4s;
            border-radius: 5px;
            position: relative;
            display: flex; /* Use flexbox for header/body/footer layout */
            flex-direction: column; /* Stack header, body, footer */
            max-height: 90vh; /* Limit max height to prevent overflow on smaller screens */
        }

        .custom-modal-content h2{
          color: white;
        }

        /* Add Animation (fade in from top) */
        @keyframes animatetop {
            from {top: -300px; opacity: 0}
            to {top: 0; opacity: 1} /* This will be relative to its natural position from margin: 10% auto; */
        }
        /* Adjusting animation for margin: 10% auto centering */
        @keyframes animatetopRealistic {
            from {margin-top: -50px; opacity: 0} /* Start off-screen adjusted for margin */
            to {margin-top: 5%; opacity: 1} /* Adjusted to match new margin */
        }


        /* Modal Header */
        .custom-modal-header {
            padding: 10px 16px;
            background-color: #0f1521; /* Example color */
            color: white;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0; /* Prevent header from shrinking */
        }
        .custom-modal-header h2 {
            margin: 0;
            font-size: 1.5em; /* Larger title */
        }

        /* Modal Body (New styles for scrollable content) */
        .custom-modal-body {
            padding: 15px 20px; /* Increased padding */
            line-height: 1.6;
            flex-grow: 1; /* Allow body to take up remaining space */
            overflow-y: auto; /* Enable vertical scrolling */
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
            /* Policy content styles within modal */
            font-size: 0.9em; /* Base font size for policies */
        }
        .custom-modal-body .policy-section h2 { /* Targeting h2 within policy section */
            font-size: 1.8em; 
            color: #0f1521;
            margin-top: 20px;
            margin-bottom: 10px;
            text-align: center;
        }
        .custom-modal-body .policy-section h3 { /* Targeting h3 within policy section */
            font-size: 1.3em;
            color: #333;
            margin-top: 15px;
            margin-bottom: 5px;
        }
        .custom-modal-body .policy-section p, .custom-modal-body .policy-section ul { /* Targeting p, ul within policy section */
            font-size: 0.95em;
            line-height: 1.6;
            color: #555;
            margin-bottom: 10px;
        }
        .custom-modal-body .policy-section ul {
            padding-left: 20px;
            list-style-type: disc;
        }
        .custom-modal-body .policy-section a {
            color: #007bff;
            text-decoration: underline;
        }
        .custom-modal-body hr {
            border-top: 1px solid #eee;
            margin-bottom: 20px;
            margin-top: 20px;
        }


        /* Modal Footer */
        .custom-modal-footer {
            padding: 10px 16px;
            background-color: #f9f9f9; /* Example color */
            text-align: right;
            border-bottom-left-radius: 5px;
            border-bottom-right-radius: 5px;
            border-top: 1px solid #eee;
            display: flex; /* Use flex for spacing and alignment */
            justify-content: space-between; /* Space out consent and buttons */
            align-items: center;
            flex-shrink: 0; /* Prevent footer from shrinking */
        }
        .custom-modal-footer button { /* Applied to custom-btn */
            padding: 8px 12px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            margin-left: 5px;
        }
        .custom-modal-footer .custom-btn-primary { /* Was .btn-primary */
            background-color: #007bff;
            color: white;
        }
        .custom-modal-footer .custom-btn-secondary { /* Was .btn-secondary */
            background-color: #6c757d;
            color: white;
        }
        .custom-modal-footer .custom-btn-primary:disabled {
            background-color: #a0a0a0;
            cursor: not-allowed;
        }


        /* The Close Button */
        .custom-modal-close-btn {
            color: white;
            font-size: 28px;
            font-weight: bold;
            line-height: 1; 
        }

        .custom-modal-close-btn:hover,
        .custom-modal-close-btn:focus {
            color: #bbb; /* Lighter color on hover for dark background */
            text-decoration: none;
            cursor: pointer;
        }
        /* Specific style for the consent checkbox within the modal footer */
        .consent-checkbox-container {
            display: flex;
            align-items: center;
            font-size: 0.9em;
            color: #555;
            flex-grow: 1; /* Allow it to take up space */
        }
        .consent-checkbox-container input[type="checkbox"] {
            margin-right: 8px;
            transform: scale(1.1);
        }
        .consent-checkbox-container a {
            color: #007bff;
            text-decoration: underline;
        }


        /* Styling for the form's submit_btn (was #openModalBtn) */
        .submit_btn { /* Changed from #openModalBtn to class */
            padding: 10px 15px;
            font-size: 16px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: block;
            width: fit-content;
            margin: 20px auto 0; /* Center button */
        }
        /* Styles for API Message */
        #apiMessage {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
            font-size: 1.1em;
            display: none; /* Hidden by default */
        }
        #apiMessage.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        #apiMessage.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        #apiMessage.info { /* Added for processing message */
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        /* Basic styling for form validation states (if you use the 'form-validated' class from JS) */
        .form-validated input:invalid {
            border-color: red !important; /* Ensure it overrides other styles */
        }
        .form-validated select:invalid {
            border-color: red !important;
        }
         /* Ensure form elements are visible and styled consistently */
        .Payment .inputBox {
            margin-bottom: 15px;
        }
        .Payment .inputBox label {
            display: block;
            margin-bottom: 5px;
            color: #333; /* Or your theme color */
        }
        .Payment .inputBox input,
        .Payment .inputBox select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .Payment .flex {
            display: flex;
            gap: 15px; /* Spacing between flex items */
        }
        .Payment .flex .inputBox {
            flex: 1; /* Allow items to grow and fill space */
        }
      </style>
   </head>
   <body>
      <div class="loader_bg">
         <div class="loader"><img src="/assets/images/loading.gif" alt="#"/></div>
      </div>
      <header>
         <div class="header">
            <div class="container">
               <div class="row">
                  <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col logo_section">
                     <div class="full">
                        <div class="center-desk">
                           <div class="logo">
                              <a href="/">
                                 <img src="/assets/images/logo.png" alt="#" />
                              </a>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="col-xl-9 col-lg-9 col-md-9 col-sm-9">
                     <nav class="navigation navbar navbar-expand-md navbar-dark ">
                        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                        </button>
                        <div class="collapse navbar-collapse" id="navbarsExample04">
                           <ul class="navbar-nav mr-auto">
                              <li class="nav-item ">
                                 <a class="nav-link" href="/">Home</a>
                              </li>
                              <li class="nav-item">
                                 <a class="nav-link" href="/html/about.html">About</a>
                              </li>
                              <li class="nav-item">
                                 <a class="nav-link" href="/html/apartments.html">Our Apartments</a>
                              </li>
                              <li class="nav-item">
                                 <a class="nav-link" href="/html/gallery.html">Gallery</a>
                              </li>
                              <li class="nav-item">
                                 <a class="nav-link" href="/html/testimonial.html">testimonial</a>
                              </li>
                              <li class="nav-item">
                                 <a class="nav-link" href="/html/contact.html">Contact Us</a>
                              </li>
                           </ul>
                        </div>
                     </nav>
                  </div>
               </div>
            </div>
         </div>
      </header>
      <div class="back_re">
         <div class="container">
            <div class="row">
               <div class="col-md-12">
                  <div class="title">
                    <h2>Your Details</h2>
                    <h1></h1>
                  </div>
               </div>
            </div>
         </div>
      </div>

      <div class="Payment">
         <div class="container payment">
     
             <div class="d-flex justify-content-between align-items-center my-4">
                 </div>
     
             <form action="#" id="paymentForm" method="post">
    <div class="row">
        <div class="col">
            <h3 class="title">Billing Address</h3>
            <div class="inputBox">
                <label for="name">Full Name:</label>
                <input type="text" id="name" placeholder="Enter your full name" required>
            </div>
            <div class="inputBox">
                <label for="email">Email:</label>
                <input type="email" id="email" placeholder="Enter email address" required>
            </div>
            <div class="inputBox">
                <label for="mobile">Mobile Number:</label>
                <input type="tel" id="mobile" placeholder="+250 7XX XXX XXX" required>
            </div>
            <div class="inputBox">
                <label for="address">Street Address:</label>
                <input type="text" id="address" placeholder="Enter street address" required>
            </div>
        </div>

        <div class="col">
            <h3 class="title">Booking Details</h3>
            <div class="inputBox">
                <label for="city">City:</label>
                <input type="text" id="city" placeholder="Enter city" required>
            </div>
            <div class="inputBox">
                <label for="country">Country:</label>
                <input type="text" id="country" placeholder="Enter country" value="Rwanda" required>
            </div>
            <div class="inputBox">
                <label for="propertyName">Property Name:</label>
                <input type="text" id="propertyName" placeholder="" required>
            </div>
            <div class="inputBox">
                <label for="TotalAmount">Total Amount (Pay at Property):</label>
                <input type="text" id="TotalAmount" placeholder="" required>
            </div>
        </div>
    </div>
    <button type="button" value="Proceed to Checkout" class="submit_btn">Next: Credit card information</button>
    <p class="text-muted" style="text-align: center; margin-top: 10px;">You won't be charged yet, you'll be paying at the property.</p>
</form>
         </div>
     </div>
     
     <!-- The Custom Modal -->
     <div id="consentModal" class="custom-modal"> 
         <div class="custom-modal-content">
             <div class="custom-modal-header">
                 <h2 id="consentModalLabel">Confidential Information Consent</h2> <!-- Removed class from h2, relying on .custom-modal-header h2 -->
                 <span id="vanillaCloseBtn" class="custom-modal-close-btn">&times;</span> 
             </div>
             <div class="custom-modal-body">
                <div class="policy-section"> <!-- Wrapper for policy content -->
                    <h2 class="text-center mb-4">Terms of Service</h2>
                    <hr>
                    <p class="text-muted text-center"><strong>Company Name:</strong> GOGO Capital Int. ApS</p>
                    <p class="text-muted text-center"><strong>Address:</strong> Bygmarken 28, 4060 Kirke Sonnerup, Denmark</p>
                    <p class="text-muted text-center"><strong>Effective Date:</strong> 01-02-2025</p>
                    
                    <h3>1. Introduction</h3>
                    <p>These Terms of Service (“Terms”) govern your access and use of the website <strong><a href="http://www.gogovillas.com">www.gogovillas.com</a></strong> (“Site” or “Service”), operated by <strong>GOGO Capital Int. ApS</strong>, a company registered and located at Bygmarken 28, 4060 Kirke Sonnerup, Denmark (“Company,” “we,” “us,” or “our”). By accessing or using the Site, you acknowledge that you have read, understood, and agree to be bound by these Terms.</p>
    
                    <h3>2. Eligibility</h3>
                    <p>You must be at least 18 years old and have the legal capacity to accept these Terms.</p>
    
                    <h3>3. Account Registration</h3>
                    <p>To access certain features of the Site, you may be required to register an account. You agree to provide accurate, current, and complete information and to maintain its accuracy.</p>
    
                    <h3>4. Bookings and Payments</h3>
                    <p>All bookings and payments made through the Site are subject to availability, pricing, and cancellation policies. By making a reservation, you authorize the Company to charge the applicable payment method for confirmed bookings.</p>
    
                    <h3>5. User Obligations</h3>
                    <p>You agree:</p>
                    <ul>
                        <li>To use the Site for lawful and authorized purposes only.</li>
                        <li>Not to attempt unauthorized access or disrupt the Site.</li>
                        <li>To respect the intellectual property rights and privacy of others.</li>
                    </ul>
    
                    <h3>6. Limitation of Liability</h3>
                    <p>To the maximum extent permitted by applicable law, the Company is not liable for any indirect, special, or consequential damages arising from your use of the Site or Services.</p>
    
                    <h3>7. Changes to Terms</h3>
                    <p>We may update these Terms periodically. Changes are effective upon posting on the Site.</p>
    
                    <h3>8. Governing Law</h3>
                    <p>These Terms are governed by and interpreted in accordance with the laws of Denmark. You agree to submit to the exclusive jurisdiction of the courts located in Denmark.</p>
    
                    <h3>9. Contact</h3>
                    <p>For questions about these Terms, contact us at:<br>
                    <strong>Email:</strong> sales@gogovillas.com<br>
                    <strong>Address:</strong> GOGO Capital Int. ApS, Bygmarken 28, 4060 Kirke Sonnerup, Denmark</p>
                </div>
    
                <div class="policy-section"> <!-- Another wrapper for privacy policy content -->
                    <h2 class="text-center mb-4">Privacy Policy</h2>
                    <hr>
                    <p class="text-muted text-center"><strong>Effective Date:</strong> 10-02-2025</p>
                    
                    <h3>1. Introduction</h3>
                    <p><a href="http://www.gogovillas.com">www.gogovillas.com</a> (“Site” or “Service”) is operated by <strong>GOGO Capital Int. ApS</strong>, located at Bygmarken 28, 4060 Kirke Sonnerup, Denmark (“Company,” “we,” “us,” or “our”). We respect your privacy and are committed to safeguarding your personal data in compliance with the General Data Protection Regulation (GDPR) (EU) 2016/679.</p>
    
                    <h3>2. Data Controller</h3>
                    <p>GOGO Capital Int. ApS is the data controller responsible for your information.<br>
                    <strong>Email:</strong> sales@gogovillas.com<br>
                    <strong>Address:</strong> Bygmarken 28, 4060 Kirke Sonnerup, Denmark</p>
    
                    <h3>3. Information We Collect</h3>
                    <p>We collect:</p>
                    <ul>
                        <li><strong>Personal Information:</strong> Name, email, phone number, billing and shipping addresses.</li>
                        <li><strong>Booking Details:</strong> Property details, special requests, payment information.</li>
                        <li><strong>Usage Data:</strong> IP address, browser information, site activity.</li>
                        <li><strong>Cookies and Similar Technologies:</strong> To understand site usage and customize experience.</li>
                    </ul>
                    <p><strong>Specific to Email Collection:</strong> We collect email addresses **only when a client makes a booking through our Site, thereby providing their explicit consent** for us to use their email for purposes directly related to their booking (confirmations, updates) and for occasional, relevant promotional offers, from which they can opt-out. We do not source email lists from third parties.</p>
    
                    <h3>4. Legal Bases for Processing</h3>
                    <p>We process your data based on one or more of the following:</p>
                    <ul>
                        <li>To fulfill a contract (e.g., process a booking).</li>
                        <li>To comply with a legal obligation.</li>
                        <li>Based on your consent.</li>
                        <li>To pursue legitimate interests (e.g., site improvement, fraud detection).</li>
                    </ul>
    
                    <h3>5. How We Use Your Information</h3>
                    <p>We use your information to:</p>
                    <ul>
                        <li>Operate and maintain the Site.</li>
                        <li>Process payments and bookings.</li>
                        <li>Communicate about reservations, changes, or promotional offers.</li>
                        <li>Analyze site usage and optimize performance.</li>
                        <li>Comply with applicable legal obligations.</li>
                    </ul>
    
                    <h3>6. Sharing Your Information</h3>
                    <p>We only share your data with:</p>
                    <ul>
                        <li>Property owners and service providers to enable bookings.</li>
                        <li>Payment processors and trusted service providers.</li>
                        <li>Legal authorities when required.</li>
                    </ul>
                    <p>We do NOT sell your data.</p>
    
                    <h3>7. International Data Transfers</h3>
                    <p>If your data is transferred outside the EEA, we implement appropriate safeguards (such as Standard Contractual Clauses) to protect your information.</p>
    
                    <h3>8. Data Retention</h3>
                    <p>We retain your information only as long as necessary for the stated purpose or as required by applicable law.</p>
    
                    <h3>9. Your Rights Under GDPR</h3>
                    <p>If you reside in the EEA, you have the right to:</p>
                    <ul>
                        <li><strong>Access</strong> your personal data.</li>
                        <li><strong>Correct</strong> or rectify any inaccurate information.</li>
                        <li><strong>Request Deletion</strong> ("Right to be Forgotten").</li>
                        <li><strong>Restrict</strong> processing.</li>
                        <li><strong>Data Portability</strong>.</li>
                        <li><strong>Object</strong> to certain processing activities.</li>
                        <li><strong>Withdraw Consent</strong> at any time.</li>
                    </ul>
                    <p>To exercise your rights, contact us at sales@gogovillas.com</p>
    
                    <h3>10. Security</h3>
                    <p>We implement industry-standard security measures to protect your data. However, no method of data transmission over the internet is completely secure.</p>
    
                    <h3>11. Cookies</h3>
                    <p>We use cookies and similar technologies for site analytics, performance optimization, and personalized user experience. You can adjust your cookie settings in your browser.</p>
    
                    <h3>12. Links to Third-Party Sites</h3>
                    <p>Our Site may contain links to external websites. We are not responsible for the privacy practices or content of those websites.</p>
    
                    <h3>13. Changes to This Policy</h3>
                    <p>We may update this Policy periodically. Changes are effective upon posting.</p>
    
                    <h3>14. Contact Us</h3>
                    <p>For questions about this Policy or to exercise your data rights:<br>
                    <strong>Email:</strong> sales@gogovillas.com<br>
                    <strong>Address:</strong> GOGO Capital Int. ApS, Bygmarken 28, 4060 Kirke Sonnerup, Denmark</p>
                </div>
            </div>                
             </div>
             <div class="custom-modal-footer">
                <div class="consent-checkbox-container">
                    <input type="checkbox" id="privacyConsentCheckbox">
                    <label for="privacyConsentCheckbox">I agree to the <a href="#termsOfService" onclick="event.preventDefault(); document.getElementById('consentModal').querySelector('.custom-modal-body').scrollTop = 0; document.getElementById('consentModal').querySelector('.custom-modal-body').scrollTo({ top: document.getElementById('modalTermsOfService').offsetTop, behavior: 'smooth' });">Terms of Service</a> and <a href="#privacyPolicy" onclick="event.preventDefault(); document.getElementById('consentModal').querySelector('.custom-modal-body').scrollTop = 0; document.getElementById('consentModal').querySelector('.custom-modal-body').scrollTo({ top: document.getElementById('modalPrivacyPolicy').offsetTop, behavior: 'smooth' });">Privacy Policy</a></label>
                </div>
                <button type="button" id="vanillaCancelBtn" class="custom-btn custom-btn-secondary">Cancel</button>
                <button type="button" id="confirmSubmitBtn" class="custom-btn custom-btn-primary">Confirm and Proceed</button>
             </div>
         </div>
     </div>

    <div class="container">
        <div id="apiMessage"></div> <!-- Message div for API responses -->
    </div>

      <footer>
         <div class="footer">
            <div class="container">
               <div class="row">
                  <div class=" col-md-4">
                     <h3>Contact US</h3>
                     <ul class="conta">
                        <li><i class="fa fa-map-marker" aria-hidden="true"></i> 255G+HXR, KK 24 Ave, Kigali</li>
                        <li><i class="fa fa-mobile" aria-hidden="true"></i> +45 40641002</li>
                        <li> <i class="fa fa-envelope" aria-hidden="true"></i><a href="#"> sales@gogovillas.com</a></li>
                     </ul>
                  </div>
                  <div class="col-md-4">
                     <h3>Menu Link</h3>
                     <ul class="link_menu">
                        <li><a href="/">Home</a></li> <li><a href="/html/about.html"> about</a></li>
                        <li><a href="/html/apartments.html">Our Apartments</a></li>
                        <li><a href="/html/gallery.html">Gallery</a></li>
                        <li><a href="/html/testimonial.html">testimonial</a></li>
                        <li><a href="/html/contact.html">Contact Us</a></li>
                     </ul>
                  </div>
                  <div class="col-md-4">
                     <h3>Visit our instagram page</h3>
                     <form class="bottom_form">
                        <input class="enter" placeholder="Enter your email" type="text" name="Enter your email">
                        <button class="sub_btn">subscribe</button>
                     </form>
                     <ul class="social_icon">
                        <li><a href="https://www.instagram.com/urugano_breeze_apartment/profilecard/?igsh=b3IyZ2xvaXZlY3c3"><i class="fa fa-instagram" aria-hidden="true"></i></a></li>
                     </ul>
                  </div>
               </div>
            </div>
            <div class="copyright">
               <div class="container">
                  <div class="row">
                     <div class="col-md-10 offset-md-1">
                        <p>© 2024 All Rights Reserved. Gogo Villas</p>
                     </div>
                  </div>
               </div>
            </div>
         </div>
       </footer>
       
       <script src="/js/jquery.min.js"></script>
       <script src="/js/bootstrap.bundle.min.js"></script>
       <script src="/js/jquery.mCustomScrollbar.concat.min.js"></script> 
       <script src="/js/custom.js"></script>

       <script>
        // Determine API Base URL for creating bookings
        const isProduction = window.location.hostname === 'gogovillas.com' || window.location.hostname === 'www.gogovillas.com';
        const CREATE_BOOKING_API_URL = isProduction
            ? "https://backend-service-432219336422.us-central1.run.app/api/bookings/create" // Production Backend for creating
            : "http://localhost:8080/api/bookings/create"; // Development Backend for creating
    
        document.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            const propertyNameValue = params.get('apartmentName');
            const totalAmountValue = params.get('totalAmount');
            // Retrieve arrival and departure dates from URL params
            const arrivalDateValue = params.get('arrivalDate');
            const departureDateValue = params.get('departureDate');
    
            const propertyInput = document.getElementById('propertyName');
            const amountInput = document.getElementById('TotalAmount');
            const apiMessageDiv = document.getElementById('apiMessage');
    
    
            if (propertyNameValue) {
                propertyInput.value = decodeURIComponent(propertyNameValue);
                propertyInput.readOnly = true;
                propertyInput.style.backgroundColor = '#e9ecef';
            }
    
            if (totalAmountValue) {
                amountInput.value = `RWF ${parseFloat(totalAmountValue).toLocaleString()}`;
                amountInput.readOnly = true;
                amountInput.style.backgroundColor = '#e9ecef';
            }
    
            // Modal elements
            const modal = document.getElementById("consentModal");
            const openBtn = document.querySelector(".submit_btn");
            const closeBtn = document.getElementById("vanillaCloseBtn");
            const cancelBtn = document.getElementById("vanillaCancelBtn");
            const confirmBtn = document.getElementById("confirmSubmitBtn");
            const paymentForm = document.getElementById("paymentForm");
            const privacyConsentCheckbox = document.getElementById('privacyConsentCheckbox');
    
            // Disable confirm button initially
            if (confirmBtn) confirmBtn.disabled = true;
    
            function showApiMessage(message, type) {
                if (apiMessageDiv) {
                    apiMessageDiv.textContent = message;
                    apiMessageDiv.className = type;
                    apiMessageDiv.style.display = 'block';
                    setTimeout(() => { apiMessageDiv.style.display = 'none'; }, 5000); // Auto-hide message
                }
            }
    
            function showModal() {
                if (modal) {
                    modal.style.display = "block";
                    document.body.classList.add("custom-modal-open");
                }
            }
    
            function hideModal() {
                if (modal) {
                    modal.style.display = "none";
                    document.body.classList.remove("custom-modal-open");
                }
            }
    
            // Event listener for the privacy consent checkbox
            if (privacyConsentCheckbox) {
                privacyConsentCheckbox.addEventListener('change', () => {
                    if (confirmBtn) {
                        confirmBtn.disabled = !privacyConsentCheckbox.checked;
                    }
                });
            }
    
    
            if (openBtn) {
                openBtn.addEventListener('click', function(event) {
                    event.preventDefault();
                    if (paymentForm && typeof paymentForm.checkValidity === 'function') {
                        if (!paymentForm.checkValidity()) {
                            paymentForm.classList.add('form-validated');
                            const firstInvalidField = paymentForm.querySelector(':invalid');
                            if (firstInvalidField && typeof firstInvalidField.focus === 'function') {
                                firstInvalidField.focus();
                            }
                            if (typeof paymentForm.reportValidity === 'function') {
                                paymentForm.reportValidity();
                            }
                            return;
                        }
                        paymentForm.classList.remove('form-validated');
                    }
                    // Reset checkbox state each time modal opens
                    if (privacyConsentCheckbox) privacyConsentCheckbox.checked = false;
                    if (confirmBtn) confirmBtn.disabled = true; // Disable confirm button on open
                    showModal();
                });
            }
    
            if (closeBtn) {
                closeBtn.addEventListener('click', hideModal);
            }
            if (cancelBtn) {
                cancelBtn.addEventListener('click', hideModal);
            }
    
            if (confirmBtn) {
                confirmBtn.addEventListener('click', async function() {
                    // Only proceed if checkbox is checked (should be disabled if not)
                    if (privacyConsentCheckbox && !privacyConsentCheckbox.checked) {
                        showApiMessage('Please agree to the Terms of Service and Privacy Policy.', 'error');
                        return;
                    }
    
                    confirmBtn.disabled = true;
                    confirmBtn.textContent = 'Processing...';
                    showApiMessage('Initiating payment...', 'info'); // Changed message
    
                    try {
                        const formData = {
                            apartment_name: document.getElementById('propertyName').value,
                            guest: document.getElementById('name').value,
                            email: document.getElementById('email').value,
                            phone: document.getElementById('mobile').value,
                            country: document.getElementById('country').value,
                            city: document.getElementById('city').value,
                            street_address: document.getElementById('address').value,
                            arrival_date: arrivalDateValue,
                            departure_date: departureDateValue,
                            // Removed card details from formData
                        };
    
                        if (!formData.arrival_date || !formData.departure_date) {
                            throw new Error("Booking dates are missing. Please go back and select your dates.");
                        }
                        
                        const response = await fetch(CREATE_BOOKING_API_URL, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify(formData),
                        });
    
                        const result = await response.json();
                        console.log('Backend createBooking response:', result);
    
                        if (response.ok) {
                            // Redirect to Stripe Checkout
                            if (result.stripeSessionUrl) {
                                window.location.href = result.stripeSessionUrl;
                            } else {
                                throw new Error("Stripe session URL not received from backend.");
                            }
                        } else {
                            throw new Error(result.error || `Request failed with status ${response.status}`);
                        }
    
                    } catch (error) {
                        console.error('Error submitting booking:', error);
                        showApiMessage(`Booking failed: ${error.message}`, 'error');
                    } finally {
                        hideModal();
                        confirmBtn.disabled = false;
                        confirmBtn.textContent = 'Confirm and Proceed';
                    }
                });
            }
    
            if (modal) {
                window.addEventListener('click', function(event) {
                    if (event.target === modal) {
                        hideModal();
                    }
                });
            }
        });
    </script>
   </body>
</html>
